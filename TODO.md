# 项目现状与架构升级详细说明

## 当前架构概述
目前系统采用了一种相对简单的架构：
- 数据源：main.py 负责爬取工作信息并生成 .txt 文件
- 数据处理：index.ts 读取这些 .txt 文件
- 数据分发：index.ts 将读取的信息发送到微信测试群

## Update:
- 增加rabbitMQ

这种架构虽然直接，但缺乏灵活性和可扩展性。

## 目标架构详解

计划将系统升级为一个更加健壮和可扩展的架构：

1. 微服务架构:
   - 优势：允许系统各部分独立开发、部署和扩展
   - 实现：将数据爬取、存储、处理和分发功能解耦为独立服务

2. PostgreSQL 数据库存储：
   - 优势：提供强大的数据管理能力，支持复杂查询和数据关系
   - 实现：设计适合工作信息存储的数据模型，包括职位、公司、位置等字段

3. REST API 数据交互：
   - 优势：标准化的数据交换方式，便于前后端分离和第三方集成
   - 实现：设计 RESTful 端点用于数据的增删改查操作

4. 人工审核流程：(预留3小时 - 从拿到每日数据到发布至微信群)
   - 优势：确保推送给用户的信息质量和相关性
   - 实现：在自动化流程中加入人工审核步骤，可能通过管理界面实现

## 详细升级方案

### 1. 数据存储升级
- 设计 PostgreSQL 数据库模式，包括 jobs, companies, locations, categories 等键和表
- 实现数据库连接和操作的抽象层(models)，便于未来可能的数据库切换

### 2. 后端重构 (main.py)
将 main.py 重构为模块化的三层架构：
- core：
  - 实现工作爬取的核心逻辑
  - 包含数据清洗和标准化流程
- utils：
  - 提供通用功能，如日期处理、字符串操作等
  - 实现日志记录和错误处理机制
- models：
  - 定义与 PostgreSQL 表对应的数据模型
  - 实现 ORM（对象关系映射）以简化数据库操作

新增 API 路由：
- GET /jobs/recent：获取最近 N 天的工作信息，支持分页和筛选
- GET /jobs/ai: ai filter with user's resume 
- GET /jobs/all：获取所有工作信息，支持分页和高级搜索

### 3. 前端更新 (index.ts)
- 重构为使用 axios 或 fetch 通过 REST API 从后端获取数据
- 实现错误处理和重试机制，提高系统稳定性
- 新增 API 路由：GET /push/all 
  - 功能：触发将审核后的工作信息发布到微信群
  - 包含安全认证机制，确保只有授权用户可以触发推送

### 4. 自动化与人工审核流程
- 使用 crontab 设置定时任务：
  1. 每 3 小时触发一次数据爬取任务
  2. 将新爬取的数据标记为"待审核"状态
  3. 通知审核人员有新数据待审核（可通过邮件或其他通知系统）
- 开发管理界面：
  - 显示待审核的工作信息
  - 提供审核操作：批准、拒绝、编辑
  - 审核通过的数据自动标记为"可推送"状态



### 5. 数据流程详解
1. 后端定时爬虫任务执行：
   - 爬取各大招聘网站的最新工作信息
   - 对原始数据进行清洗和标准化
   - 将处理后的数据存入 PostgreSQL 数据库，状态为"待审核"
2. 人工审核阶段：
   - 审核人员通过管理界面查看新数据
   - 对每条数据进行审核，确保信息准确性和相关性
   - 批准的数据状态更新为"可推送"
3. 前端数据获取：
   - index.ts 定期调用 API 获取"可推送"状态的数据
   - 实现数据缓存机制，减少不必要的 API 调用
4. 数据推送到微信群：
   - 将获取的"可推送"数据格式化为适合微信展示的格式
   - 使用微信 API 将信息推送到指定群组
   - 记录推送日志，包括推送时间、内容摘要和接收状态




# 项目功能清单
--------- v1 ---------
## 1. 数据持久化存储 - branch/persistency-data 
**描述**: 将爬取的各类别工作数据持久化存储到PostgreSQL数据库中。
**任务**:
- [ ] 设计数据库模式
- [ ] 实现CSV到PostgreSQL的数据导入脚本
- [ ] 设置定期数据更新机制
- [ ] 实现数据查询API
**负责人**:
晶
**状态**:
In progress
**截止日期**:



## 2. 用户简历管理系统
**描述**: 通过微信公众号实现用户简历的私密上传、存储和管理。

### 2.1 微信公众号设置
- [ ] 注册微信公众号
- [ ] 配置公众号基本信息
- [ ] 开发公众号菜单和基本功能
**负责人**:
**状态**:
**截止日期**:

### 2.2 用户数据持久化
- [ ] 设计用户数据模型
- [ ] 实现用户认证和授权系统
- [ ] 开发用户数据CRUD操作API
- [ ] 实现数据加密存储
**负责人**:
**状态**:
**截止日期**:

### 2.3 简历上传和OCR服务
- [ ] 开发简历上传功能
- [ ] 集成OCR服务进行简历文本提取
- [ ] 实现简历数据结构化存储
- [ ] 开发简历预览和编辑功能
**负责人**:
**状态**:
**截止日期**:


## 3. AI驱动的简历-工作匹配系统
**描述**: 使用RAG(检索增强生成)系统实现简历与工作描述的智能匹配。
**任务**:
- [ ] 设计和实现向量数据库
- [ ] 开发文本嵌入模型
- [ ] 实现相似度搜索算法
- [ ] 开发匹配结果排序和过滤机制
- [ ] 集成大语言模型进行结果优化
**负责人**:
**状态**:
**截止日期**:





--------- v2 ---------
## 4. 前端网站开发
**描述**: 开发一个用户友好的前端网站,展示匹配结果和管理用户账户。
**任务**:
- [ ] 设计网站UI/UX
- [ ] 实现用户注册和登录功能
- [ ] 开发工作搜索和浏览界面
- [ ] 实现简历上传和管理界面
- [ ] 开发匹配结果展示页面
- [ ] 实现响应式设计,确保移动端兼容性
**负责人**:
**状态**:
**截止日期**:

## 5. 系统集成和测试
**描述**: 整合所有组件并进行全面测试。
**任务**:
- [ ] 集成所有后端服务
- [ ] 连接前端与后端API
- [ ] 进行单元测试和集成测试
- [ ] 执行用户验收测试
- [ ] 进行性能和安全测试
**负责人**:
**状态**:
**截止日期**:

## 6. 部署服务到AWS Lambda和维护
**描述**: 将系统部署到生产环境并制定维护计划。
**任务**:
- [ ] 设置生产服务器环境
- [ ] 配置CI/CD管道
- [ ] 实施监控和日志系统
- [ ] 制定备份和恢复策略
- [ ] 编写系统文档和用户手册
**负责人**:
**状态**:
**截止日期**:
